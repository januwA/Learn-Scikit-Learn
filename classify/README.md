# Cat vs Dog Image Classifier (Scikit-Learn)

这是一个使用 Scikit-Learn 实现的简单猫狗图像分类器。它通过将图像缩放并展平为像素向量，使用支持向量机 (SVM) 进行训练和预测。

## 项目结构

- `classify_cats_dogs.py`: 核心逻辑库，包含图像预处理、模型训练和预测函数。
- `run_training.py`: 训练脚本，加载数据并生成模型文件。
- `run_predict.py`: 预测脚本，支持从命令行传入图片路径进行识别。
- `download_cat.py`: 从 The Cat API 批量下载猫咪图片。
- `download_dog.py`: 从 Dog CEO API 批量下载狗狗图片。
- `data/`: 存放训练数据的目录（`cats/` 和 `dogs/`）。

## 快速开始

### 1. 准备数据
首先需要下载一些图片用于训练。你可以运行下载脚本：

```bash
# 从 API 下载图片
uv run python ./classify/download_cat.py
uv run python ./classify/download_dog.py
```

### 2. 训练模型
运行训练脚本来生成模型文件 (`.pkl`)：

```bash
uv run python ./classify/run_training.py
```

训练完成后，会在 `classify/` 目录下生成 `cat_dog_model.pkl` 和 `label_encoder.pkl`。

### 3. 进行预测
使用训练好的模型来识别一张新的图片。预测结果会包含**各个类别的概率**以及**最终结果的置信度**：

```bash
uv run python ./classify/run_predict.py "你的图片路径"
```

**输出示例：**
```
预测概率: [0.229 0.771]
预测结果: 这是一只 dogs (置信度: 77.05%)
```

## 技术细节
- **图像预处理**: 统一缩放为 64x64 像素，转换为灰度图，并进行归一化（0-1）。
- **降维 (PCA)**: 使用 **主成分分析 (PCA)** 保留 90% 的方差信息。这显著降低了特征维度（从 4096 降至 约 70），有效地过滤了背景噪音并提升了计算效率。
- **自动调参 (GridSearchCV)**: 引入交叉验证搜索技术，自动在 `rbf`, `poly`, `linear` 等多个内核及不同的 `C`, `gamma` 参数组合中寻找最优解。
- **概率估算**: 启用了 `probability=True` 以便获取预测时的置信度。
- **持久化**: 使用 `joblib` 保存模型 (`.pkl`)、标签编码器以及 PCA 转换器。

## 学习心得：传统机器学习的局限
通过本项目实践，我们观察到：
1. **维度灾难**: 原始像素维度极高，直接训练不仅慢且容易受干扰。`PCA` 是解决此类问题的有力武器。
2. **特征瓶颈**: 即使有了 PCA 和自动调参，准确率在不使用 HOG 等高级特征提取的情况下，依然难以突破图像分类的物理瓶颈。
3. **数据依赖**: 在小样本（<200张）情况下，传统机器学习的表现基本处于“勉强辨别”阶段。

## 局限性与改进方向
1. **特征提取优化**：目前的模型依然基于像素分布。若要大幅提升，建议引入 **HOG (方向梯度直方图)**。
2. **数据质量**：API 返回的图片质量参差不齐，包含大量背景干扰，这对于“像素驱动”的传统算法是巨大的挑战。

## 注意事项
- 模型文件 (`*.pkl`)、`pca_model.pkl` 和 `data/` 目录下的图片已被加入 `.gitignore`。
- 脚本内的路径均已处理为相对脚本所在位置的绝对路径，可在任何工作目录下放心调用。
